
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head><title>
	Microsoft Online Password Reset
</title><meta http-equiv="x-ua-compatible" content="IE=9" /><meta http-equiv="Expires" content="0" /><meta http-equiv="Pragma" content="no-cache" /><meta http-equiv="Cache-Control" content="no-store, no-cache" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="robots" content="noindex, nofollow, NOODP, NOYDIR" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link id="FavoriteIcon" rel="Shortcut Icon" type="image/x-icon" href="favicon.ico?v=1342177280" />

    <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-3.5.0.min.js" type="text/javascript"></script>
    <script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="js/jquery-3.5.0.min.js">\x3C/script>')</script>
    <script type="text/javascript" src="js/Common.js"></script>
    <script type="text/javascript" src="js/Webtrends.js"></script>

    <!--[if lt IE 7]>
    <style type="text/css">
        .container { height:100%; }
    </style>
    <![endif]-->
    <style type="text/css">
        .header { height: 60px; font-family: "Segoe UI", Tahoma, Verdana, Arial, Sans-Serif; }   
        .header .logo { padding-top: 10px; float:left; height: 30px; }    
        .footer { bottom: 0; position: absolute; font-family: Tahoma, Verdana, Arial, Sans-Serif; font-size: 11px; height: 30px; color: #ffffff; letter-spacing: 0.05em; width: 100%; }   
        .footer .title { height: 22px; background-color: #d1510f; width: 50%; padding-top: 8px; }    
        .footer a { text-decoration:none; color : #ffffff; }
    </style>
    <link id="StyleSheet" rel="stylesheet" type="text/css" href="css/Style.css?v=1342177280" /><link id="CultureSensitiveStyleSheet" rel="stylesheet" type="text/css" href="css/ltrStyle.css?v=1342177280" />
</head>
<body onload="OnLoad()">
    <form method="post" action="./" onsubmit="javascript:return WebForm_OnSubmit();" id="form1" autocomplete="off" class="container" role="main">
<div class="aspNetHidden">
<input type="hidden" name="__LASTFOCUS" id="__LASTFOCUS" value="" />
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="pN7Yhj39k8eljhagn1Jmi8L+bkZpazp7D4H+XW+w90agGkjcqS6Ysb7DUUuWpO+Ek9xqHfnOj9209zZ66FEoR1eop9MsLbTym1ilYAzzMCFU+tamr7bNM9URzNtjJd0SXDfTerA4xJqPr2caUTr/BZ/CDuaBQT/A15VdZi9/Bfe4h38TxQmKDG5Rd5cuME4smwcrQguGX+B223gjfjNtCQ4Yb0OiZqGo/du3sx85InAPGe8QpPxOL6hYLEDhkkZrKOSoHXEYyxcu0Em7L9RlCOKfAAVuQuGvStAa/iF8Re8BmH1Bpgn8EQ0OQNvj7LAnWJ4UN07bCLgtZohBfJYgV3GKIIZr9zmsuduTEYGbaq0iAtQ5ICDKi4c+aKsbod3BM2sxssnQc4u2MZB2oICNzWxdpYaifnUH+40b5zFnGWX2kUcFeBCecyFP/HCBE+xVT/85nbUwfIK+ZkTB0S/i+A==" />
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>


<script src="/WebResource.axd?d=pKFh5xeRN8PJAz0BVdbe7rXGUO3c-1wRd2o8h6gSsklGIjFCBDl4AlJFWbIPYepeXwhAY_QFBs61QJYh_65gZF6FugcIAPLfHHxG9-OHEDZox21t3dM4rFGjnhmtvz9W3Yx6c63uF5FloWxjjzI6Nw2&amp;t=638229010275096262" type="text/javascript"></script>


<script src="js/Button.js?v=1342177280" type="text/javascript"></script>
<script src="/ScriptResource.axd?d=UwsuM3VwkdCwX6rhIT-RE0FWw7XVZpI2jwfbtLwkqYjTnGxqOa6XZQlk0-vn9giOoUXfehdjc4JQIp8nNTeZe1nZ4TJVEpNt4-qjeSePlX9gQ5OAnuMifyfH24fLubaYH6aVdcK8-0C3aWGzAKHI9bdiNiO38sgXQ1nFV0wCpeoFMUqSyYe8le4JmPN3AcQAhTJdZYPaLfEpP4FtWFH1eA2&amp;t=2265eaa7" type="text/javascript"></script>
<script src="/ScriptResource.axd?d=0y7360K-XJ0GqgoeN8p8vMLSEmwARrpStgby71NTITHQOlC1EJbB_n7NqX0gGZCevJ7YOcwzagvCfts3q996B0he7xT9LivEjsgNO0Dy0S8Ng0w-h-ENRVqjDGXq--KQh6c1IznOKPu1o5g8QYPZWLGuRRtMDCD8Q_SN0qStY8uoMFfwXyNFj4SRwBrxu7etkoDweK_SMQxGRqith2cneLNKvtEmGbP5Bl28W3rHCEk1&amp;t=ffffffffaa493ab8" type="text/javascript"></script>
<script src="/ScriptResource.axd?d=DXaHrxwJURfzR2VYECyoLfSunxge4nHtYo5AycThzHU0VDRWdLJoJ80AC6q2sgBhgb-NG27YgoIQXzqSX14C1f9mEoC36ZQx_aeeroyrLkYRtYKSeDEKbWOdMWt8EVa6cZvCczX4iNVsrMHrtN_l-q--HHqgfHzVx5H7i12nONvyRrdqFsLSwLCMkOwbsEdQ1DBA-gMNH0bAq5vDZC4DSFIahT6B2aWQttTRPwkONFk1&amp;t=ffffffffaa493ab8" type="text/javascript"></script>
<script src="/WebResource.axd?d=7pM9cfTD6fSy6JhJHuV8yzFlkLVZKbpD3UHRty30GWiHpJ6I0c7TUkwm-c3OU_BNTOVHragdJ007m1HVeEadvekgdAvPiQQPZxmO9nWTh7OlpSeYmlnT3kTgiAM8JqiyhYRvt5Ii1AYf5gETiLIxxQ2&amp;t=638229010275096262" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
//]]>
</script>

<div class="aspNetHidden">

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="CA0B0334" />
	<input type="hidden" name="__VIEWSTATEENCRYPTED" id="__VIEWSTATEENCRYPTED" value="" />
	<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="6j2DFz95IWQD4Cr4TNpFiIUeqPEVFNEObPdJnkL6IPHBajEOWZFfevF5vpIB2mkjTT+1yvdWcU6PsRiZzPtgIyFKpE4o1AiAiC1NWY/sl2c1cbfKHOkEZKgtSdYcl5s1oWqTjHQX22TS1m7q2Mu0RYWMw5v5mz0umabpU4oKS4q9uN+FeIeOkrW80+o0s5xaynR8AwerRIZFvC7q8DSEKqsLOO2ICBNMgks9QBF0sffHI0/Q7oa+6Gnu+UkSLO2X0s8SmYd5+PG3mwiRh0TK2F+hMdtdDbiSFaRKquJHK40QVc3GTWb2SyAmSG6m+WkxkISbYo/BmrXfA3KA88f4sym+BBdSG3G3tkTU6rQONYSn/sBGcHjB6vew5xHFZk3yrdsjVtL187rgAyXiEfVR7KXgfyHZCNqg9eIPT0jVhBTJNWZXjMsk7FAfJZbF/9J/kfP46/R0cxdSiebXPwCGAg==" />
</div>
        <script type="text/javascript">
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('ctl00$ScriptManagerMain', 'form1', ['tctl00$UpdatePanelLogo','UpdatePanelLogo','tctl00$ContentPlaceholderMainContent$UpdatePanelMain','ContentPlaceholderMainContent_UpdatePanelMain'], [], [], 60, 'ctl00');
//]]>
</script>


        <div id="UpdatePanelLogo">
	
                <div class="header" role="banner">
                    <img id="HeaderImage" class="logo" src="/images/header_microsoft.png" />
                </div>    
            
</div>

        
    <div class="content">
        <div id="ContentPlaceholderMainContent_UpdatePanelMain" role="form">
	
                <h1>
                    Get back into your account
                    <span id="ContentPlaceholderMainContent_LabelHeaderPreviewTag" class="preview-badge-ontitle" style="display:none">Preview</span>
                </h1>
                
                        <h2 class="title marginTB20">
                            <span id="ContentPlaceholderMainContent_LabelViewUserIdentifierVerificationHeader">Who are you?</span>
                        </h2>
                        <div class="marginTB20">
                            <span id="ContentPlaceholderMainContent_LabelViewUserIdentifierVerificationInstructions">To recover your account, begin by entering your email or username and the characters in the picture or audio below.</span>
                        </div>
                        <table cellpadding="0" cellspacing="0" role="presentation">
                            <tr>
                                <td style="vertical-align:middle;" class="userVerificationInputLabel">
                                    <label>
                                        Email or Username:
                                        <span class="requiredstar">*</span>
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input name="ctl00$ContentPlaceholderMainContent$TextBoxUserIdentifier" type="text" id="ContentPlaceholderMainContent_TextBoxUserIdentifier" tabindex="1" autocomplete="off" spellcheck="false" dir="ltr" onblur="Javascript:PopulateUserNameHiddenFieldAndRefreshLogo();" onchange="HideUserIdErrorLabel();" aria-required="true" title="Enter your email address" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span id="ContentPlaceholderMainContent_UserIdentifierExample" for="<%= TextBoxUserIdentifier.ClientID %>">Example: user@contoso.onmicrosoft.com or user@contoso.com</span>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span id="ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier" tabindex="-1" role="alert" aria-live="polite" tabIndex="0" style="color:#B30000;display:none;">Please type your email address in the format user@contoso.onmicrosoft.com or user@contoso.com</span>
                                    <span id="ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier" tabindex="-1" role="alert" aria-live="polite" tabIndex="0" style="color:#B30000;display:none;">Please type your email address in the format user@contoso.onmicrosoft.com or user@contoso.com</span>

                                    <!-- The ErrorMessage has an <a href> link that takes tabindex="2" -->
                                    <span id="ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains" tabindex="-1" role="alert" aria-live="polite" tabIndex="0" style="color:#B30000;display:none;">Microsoft Accounts or personal email addresses donâ€™t work here.  Make sure you enter your work or school account (e.g. user@contoso.com).  If you want to reset a Microsoft Account password, <a href="https://account.live.com/resetpassword.aspx" >click here</a>.</span>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="errorClass">
                                        <!-- server sets style="display:inline" -->
                                        <span id="ContentPlaceholderMainContent_UserIdErrorLabel" style="display:none"></span>
                                    </div>
                                </td>
                            </tr>
                            <tr><td colspan="2" style="padding-top: 10px;"></td></tr>
                            <tr id="ContentPlaceholderMainContent_RepMapCaptchaContent">
		<td>
                                    <table cellpadding="0" cellspacing="0" role="presentation">
                                        <tr>
                                            <td style="text-align:center;height:90px;max-width:240px;">
                                                <img id="RepMapVisualChallenge" aria-label='Captcha'/>
                                                <audio id="RepMapAudioChallenge" class="hidden"> </audio>
                                                <a id="RepMapAudioPlayControl" onclick="repMapService.playAudioChallenge(event);" role="button" title='Play the audio'
                                                    tabindex="1" href="">
                                                    <img role="button" class="cssWLSPHIPAudio" src="https://client.ppe.repmap.microsoft.com:443/Images/hipaudioplay.png?vv=100" alt='Play the audio'>
                                                </a>
                                                <img id="RepMapChallengeLoading" src="/images/wait_animation.gif" class="hidden"/>
                                            </td>
                                            <td style="vertical-align:top;">
                                            <table role="presentation">
                                                <tr>
                                                    <td style="vertical-align:top;">
                                                        <a id="toggleChallengeTypeControl" class="action-link tooltip-wrapper" onclick="repMapService.toggleRepMapServiceChallengeType(event);" role="button"
                                                            aria-label='Use audio mode' tabindex="2" href="">
                                                            <span id="ContentPlaceholderMainContent_RepMapChallengeTypeLabel" class="tooltip">Use audio mode</span>
                                                            <img id="ContentPlaceholderMainContent_RepMapChallengeTypeAudioIcon" role="button" src="/images/hip_speaker.png" alt="Use audio mode" />
                                                            <img id="ContentPlaceholderMainContent_RepMapChallengeTypeVisualIcon" role="button" class="hidden" src="/images/hip_text.gif" alt="Use picture mode" />
                                                        </a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <a id="reloadRepMapChallengeControl" class="action-link tooltip-wrapper" onclick="repMapService.reloadRepMapChallenge(event);" role="button"
                                                            aria-label='Reload' tabindex="3" href="">
                                                            <span id="ContentPlaceholderMainContent_RepMapReloadLabel" class="tooltip">Reload</span>
                                                            <img id="ContentPlaceholderMainContent_RepMapReloadIcon" role="button" src="/images/hip_reload.png" alt="Reload" />
                                                        </a>
                                                    </td>
                                                </tr>
                                              </table>
                                            </td>
                                        </tr>
                                        <tr>
                                             <td>
                                               <input id='RepMapChallengeSolution' name="RepMapChallengeSolution" aria-labelledby="LabelCaptchaInstructions"/>
                                               <input id='RepMapChallengeId' name="RepMapChallengeId" class="hidden"/>
                                               <input id='RepMapChallengeAzureRegion' name="RepMapChallengeAzureRegion" class="hidden"/>
                                               <input id='RepMapChallengeType' name="RepMapChallengeType" class="hidden"/>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
	</tr>
	
                            <tr>
                                <td>
                                    <span id="LabelCaptchaInstructions">Enter the characters in the picture or the words in the audio.
                                        <span class="requiredstar">*</span>
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="errorClass" aria-live="assertive" role="alert">
                                        <!-- Server sets style="display:inline" to show the alert. But Narrator does not recognize that change 
                                             So explicitly using aria-hidden property. This is set to false in a postLoad handler UnHideCaptchaError()-->
                                        <div id="ContentPlaceholderMainContent_LabelCaptchaError" aria-hidden="true" style="display:none">

	</div>
                                        <div id="GetCaptchaError" style="display:none" aria-hidden="true" >Error in getting captcha. Please try again by clicking the reload icon.</div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    
                <br />
                <div id="ContentPlaceholderMainContent_PanelButtons">
		
                    <div>
                        <span id="Buttons">
                            <span id="ContentPlaceholderMainContent_ButtonNext_disabled" class="Button-disabled" style="display:none;">Next</span><a onclick="ButtonNextClick(this);" id="ContentPlaceholderMainContent_ButtonNext" class="Button-focus" role="button" boxtype="Button" href="javascript:__doPostBack(&#39;ctl00$ContentPlaceholderMainContent$ButtonNext&#39;,&#39;&#39;)" onmouseover="Button.MouseOver(&#39;ContentPlaceholderMainContent_ButtonNext&#39;);" onmouseout="Button.MouseOut(&#39;ContentPlaceholderMainContent_ButtonNext&#39;);" onmousedown="Button.MouseDown(&#39;ContentPlaceholderMainContent_ButtonNext&#39;);" onfocus="Button.Focus(&#39;ContentPlaceholderMainContent_ButtonNext&#39;);" onblur="Button.Blur(&#39;ContentPlaceholderMainContent_ButtonNext&#39;);" uniqueid="ctl00$ContentPlaceholderMainContent$ButtonNext" style="display:inline-block;display:inline-block;"><span>Next</span></a><script type="text/javascript">
			Button.AddGroup('ContentPlaceholderMainContent_ButtonNext','ContentPlaceholderMainContent_ButtonNext');
		</script>
                        
                            <a onclick="ButtonCancelClick();" id="ContentPlaceholderMainContent_ButtonCancel" class="ButtonAsLink" role="button" href="javascript:__doPostBack(&#39;ctl00$ContentPlaceholderMainContent$ButtonCancel&#39;,&#39;&#39;)">Cancel</a>
                        </span>
                    </div>
                
	</div>
                <input type="hidden" name="ctl00$ContentPlaceholderMainContent$CurrentViewName" id="ContentPlaceholderMainContent_CurrentViewName" value="ViewUserIdentifierVerification" />
                <input type="hidden" name="ctl00$ContentPlaceholderMainContent$LiveCaptchaMode" id="ContentPlaceholderMainContent_LiveCaptchaMode" value="Image" />
                
                
                <input type="hidden" name="ctl00$ContentPlaceholderMainContent$WorkflowConsistencyCheck" id="ContentPlaceholderMainContent_WorkflowConsistencyCheck" value="638256711348416477" />
                <a id="ContentPlaceholderMainContent_ConsistencyError_Button" href="javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;ctl00$ContentPlaceholderMainContent$ConsistencyError_Button&quot;, &quot;&quot;, true, &quot;&quot;, &quot;&quot;, false, true))" style="visibility:hidden"></a>
                
                
                

            
</div>
        <div class="updateProgress">
            <div id="ContentPlaceholderMainContent_UpdateProgress1" style="visibility:hidden;display:block;">
	
                    <img id="ContentPlaceholderMainContent_MainWaitAnimation" src="/images/wait_animation.gif" alt="Loading" />
                
</div>
        </div>

       <script type="text/javascript">
         
           function pageLoad() {
               CheckWorkflowConsistency();
               ShowPasswordPopup();
               InitializePasswordStrengthMeterAndHelpContainerOnLoad();
               repMapService.showRepMapServiceChallenge();
           }

            var notifyAdministratorClicked = 0;
            
            function ButtonNextClick(sender) {
                if ($get('Buttons').style.display == 'none') {
                    sender.disabled = 'true';
                    return false;
                }

                captchaError = $get('ContentPlaceholderMainContent_LabelCaptchaError');
                SetDisplayStateNone(captchaError);

                // do client side validation
                if (typeof (Page_ClientValidate) == 'function') {
                    if (Page_ClientValidate() == false) {
                        // clear error strings that are set server side to show client side validation errors
                        var userIdErrorLabel = $get('ContentPlaceholderMainContent_UserIdErrorLabel');
                        if (userIdErrorLabel) {
                            userIdErrorLabel.style.display = 'none';
                        }
                        var labelCaptchaError = $get('ContentPlaceholderMainContent_LabelCaptchaError');
                        if (labelCaptchaError) {
                            labelCaptchaError.style.display = 'none';
                        }
                        var labelSetPasswordErrorMessage = $get('ContentPlaceholderMainContent_LabelSetPasswordErrorMessage');
                        if (labelSetPasswordErrorMessage) {
                            labelSetPasswordErrorMessage.style.display = 'none';
                        }
                        return false;
                    }
                }
                // hide buttons 
                $get('Buttons').style.display = 'none';
           }

            function ButtonCancelClick() {
                $get('Buttons').style.display = 'none';
            }


           function ButtonContactAdministratorClick(button) {
               if (notifyAdministratorClicked != 0) {
                   return false;
               }
               else {
                   notifyAdministratorClicked = notifyAdministratorClicked + 1;
               }
           }

           function ButtonContactAdministrator_ClientClick(button) {
               var hiddenAnchor = $get('ContentPlaceholderMainContent_ContactAdmin_Hidden_Anchor');               
               
               if (hiddenAnchor && hiddenAnchor.click) {
                   hiddenAnchor.click();
                   return false;
               }
               ButtonContactAdministratorClick(button);
           }

            // Toggles style.display of given element between 'none' and 'block'
            function ToggleDisplayState(elementId) {
                var element = $get(elementId);
                if (element) {
                    if (element.style.display == 'none') {
                        element.style.display = 'block';
                    }
                    else {
                        element.style.display = 'none';
                    }
                }
            }

            function FindAndSetDisplayState(elementId, displayState, ariaHidden) {
                var element = $get(elementId);
                if (element) {
                    element.style.display = displayState;
                    var tooltipLabel = $get('ContentPlaceholderMainContent_ViewNewPasswordInstructionsLabel');
                    tooltipLabel.setAttribute('aria-hidden', ariaHidden);
                }
            }

            // Changes style.display of given element to 'none'
            function SetDisplayStateNone(element) {
                if (element) {
                    element.style.display = 'none';
                }
            }

            function ShowPasswordPopup() {
                var popupControl= $find('PasswordPopupBehavior');
                if(popupControl)
                    popupControl.showPopup();
            }

            function InitializePasswordStrengthMeterAndHelpContainerOnLoad() {
                var passwordTextBox = $get('ContentPlaceholderMainContent_TextBoxPassword1');
                if (passwordTextBox) {
                    var passwordStrengthControl = $get('ContentPlaceholderMainContent_StrengthMeterProgressBar');
                    if (passwordStrengthControl) {
                        InitializePasswordStrengthMeter();
                    }
                    else {
                        FindAndSetDisplayState('HelpCalloutContainer', 'none', 'true');
                    }
                }
                    
            }

           function HideUserIdErrorLabel() {
               var element = $get('ContentPlaceholderMainContent_UserIdErrorLabel');
               if (element)
                   element.style.display = 'none';
           }

           var skipEmptyCheckOnTextBoxPassword1Validator = false;
           function CustomValidatorTextBoxPassword1(source, args) {
               $get('ContentPlaceholderMainContent_LabelSetPasswordErrorMessage').innerText = '';
               args.IsValid = true;
               if ($get('ContentPlaceholderMainContent_TextBoxPassword1').value == "") {
                   args.IsValid = false;
                   if (skipEmptyCheckOnTextBoxPassword1Validator == false) {
                       $get('ContentPlaceholderMainContent_LabelTextBoxPassword1Missing').style.display = 'block';
                       $get('ContentPlaceholderMainContent_LabelTextBoxPassword1Mismatch').style.display = 'none';
                       $get('ContentPlaceholderMainContent_TextBoxPassword2').value = '';
                       $get('ContentPlaceholderMainContent_TextBoxPassword1').focus();
                       ShowPasswordPopup();
                       return;
                   }
               }
               skipEmptyCheckOnTextBoxPassword1Validator = false;
               if ($get('ContentPlaceholderMainContent_TextBoxPassword2').value != $get('ContentPlaceholderMainContent_TextBoxPassword1').value) {
                   $get('ContentPlaceholderMainContent_LabelTextBoxPassword1Mismatch').style.display = 'block';
                   $get('ContentPlaceholderMainContent_LabelTextBoxPassword1Missing').style.display = 'none';
                   args.IsValid = false;
                   skipEmptyCheckOnTextBoxPassword1Validator = true;
                   $get('ContentPlaceholderMainContent_TextBoxPassword2').value = '';
                   $get('ContentPlaceholderMainContent_TextBoxPassword1').value = '';
                   $get('ContentPlaceholderMainContent_TextBoxPassword1').focus();
               }
               ShowPasswordPopup();
           }
          
           function CheckWorkflowConsistency() {
               var cookieValue = GetCookieValue('WorkflowConsistencyCheck');
               var workflowControl = $get('ContentPlaceholderMainContent_WorkflowConsistencyCheck');

               if (workflowControl) {

                   if (cookieValue == "" || workflowControl.value == "") {
                       return;
                   }

                   if (cookieValue != workflowControl.value) {
                       var consistencyErrorButton = $get('ContentPlaceholderMainContent_ConsistencyError_Button');

                       if (consistencyErrorButton) {
                           consistencyErrorButton.click();
                           return;
                       }
                   }
               }

               return;
           }
       </script>
        <script type="text/javascript">
            var repMapService = {
                _currentViewNameId: '#' + 'ContentPlaceholderMainContent_CurrentViewName',
                _challengeTypeVisual: 'Visual',
                _challengeTypeAudio: 'Audio',
                _challengeApiUrl: 'Default.aspx/GetCaptchaChallenge',
                _challengeApiMethod: 'POST',
                _challengeApiContentType: 'application/json; charset=utf-8',
                _challengeLoadingId: '#RepMapChallengeLoading',
                _audioIconId: '#' + 'ContentPlaceholderMainContent_RepMapChallengeTypeAudioIcon',
                _visualIconId: '#' + 'ContentPlaceholderMainContent_RepMapChallengeTypeVisualIcon',
                _repMapCaptchaRootContentId: '#' + 'ContentPlaceholderMainContent_RepMapCaptchaContent',
                _visualChallengeElementId: '#RepMapVisualChallenge',
                _audioChallengeElementId: '#RepMapAudioChallenge',
                _base64VisualPrefix: 'data:image/jpeg;base64, ',
                _base64AudioPrefix: 'data:audio/mp3;base64, ',
                _audioPlayControlId: '#RepMapAudioPlayControl',
                _challengeIdInputId: '#RepMapChallengeId',
                _challengeTypeInputId: '#RepMapChallengeType',
                _challengeAzureRegionInputId: '#RepMapChallengeAzureRegion',
                _getCaptchaErrorMsgId: '#GetCaptchaError',
                _toggleChallengeTypeControlId: '#toggleChallengeTypeControl',
                _toggleChallengeTypeControlTooltip: '#toggleChallengeTypeControl .tooltip',
                _currentChallenge: {
                    challengeType: 'Visual',
                    challengeId: ''
                },
                toggleRepMapServiceChallengeType: function (clickEvent) {
                    clickEvent.preventDefault(); // Preventing navigation to href=""
                    var tooltipText = '';

                    if (this._currentChallenge.challengeType === this._challengeTypeVisual) {
                        this._currentChallenge.challengeType = this._challengeTypeAudio;
                        $(this._audioIconId).hide();
                        $(this._visualChallengeElementId).hide();
                        $(this._visualIconId).show();
                        tooltipText = "Use picture mode";
                    } else {
                        this._currentChallenge.challengeType = this._challengeTypeVisual;
                        $(this._audioIconId).show();
                        $(this._visualChallengeElementId).show();
                        $(this._visualIconId).hide();
                        $(this._audioPlayControlId).hide();
                        tooltipText = "Use audio mode";
                    }

                    $(this._toggleChallengeTypeControlId).attr('aria-label', tooltipText);
                    $(this._toggleChallengeTypeControlTooltip).text(tooltipText);

                    $(this._visualChallengeElementId).attr("src", '');
                    $(this._audioChallengeElementId).attr("src", '');
                    this.reloadRepMapChallenge();
                },
                showRepMapServiceChallenge: function () {
                    if ($(this._currentViewNameId).val() === 'ViewUserIdentifierVerification') {
                        this.reloadRepMapChallenge();
                    }
                },
                playAudioChallenge: function (clickEvent) {
                    $(this._audioChallengeElementId)[0].play();
                    clickEvent && clickEvent.preventDefault && clickEvent.preventDefault();
                },
                reloadRepMapChallenge: function (clickEvent) {
                    clickEvent && clickEvent.preventDefault && clickEvent.preventDefault(); // Preventing navigation to href=""

                    $(this._audioPlayControlId).hide();
                    $(this._visualChallengeElementId).hide();
                    $(this._challengeLoadingId).show();
                    $(this._getCaptchaErrorMsgId).hide();
                    var self = this;
                    $.ajax({
                        type: self._challengeApiMethod,
                        url: self._challengeApiUrl,
                        contentType: self._challengeApiContentType,
                        data: JSON.stringify({
                            challengeType: self._currentChallenge.challengeType
                        }),
                        success: function (response) {
                            var responseJson = JSON.parse(response.d);
                            self._currentChallenge.challengeId = responseJson.ChallengeId;
                            $(self._challengeIdInputId).val(responseJson.ChallengeId);
                            $(self._challengeAzureRegionInputId).val(responseJson.AzureRegion);
                            $(self._challengeTypeInputId).val(self._currentChallenge.challengeType);

                            if (self._currentChallenge.challengeType === self._challengeTypeVisual) {
                                var imgBase64 = self._base64VisualPrefix + responseJson.ChallengeData;
                                $(self._visualChallengeElementId).attr("src", imgBase64);
                                $(self._visualChallengeElementId).show();
                            } else {
                                var audioBase64 = self._base64AudioPrefix + responseJson.ChallengeData;
                                $(self._audioChallengeElementId).attr("src", audioBase64);
                                $(self._audioPlayControlId).show();
                            }
                            $(self._challengeLoadingId).hide();
                        },
                        error: function (response) {
                            $(self._challengeLoadingId).hide();
                            $(self._getCaptchaErrorMsgId).show();
                            self.resetChallengeInput();
                        }
                    });
                },
                resetChallengeInput: function () {
                    this._currentChallenge.challengeId = null;
                    $(this._challengeIdInputId).val(null);
                    $(this._challengeAzureRegionInputId).val(null);
                    $(this._challengeTypeInputId).val(null);
                }
            };
        </script>
    </div>

        <input type="hidden" name="ctl00$CorrelationID" id="CorrelationID" value="f30ee174-c753-4240-b2de-5d5dea231743" />
        <input type="hidden" name="ctl00$OrgIdUserName" id="OrgIdUserName" />
        <input type="hidden" name="ctl00$OrgIdTenantDomain" id="OrgIdTenantDomain" />
        <input type="hidden" name="ctl00$NameCoexistenceAccount" id="NameCoexistenceAccount" />
        <div role="contentinfo">
            <table cellpadding="0" cellspacing="0" class="footer" role="presentation">
                <tbody>
                    <tr class="title">
                        <td align="left">
                            <table cellpadding="0" cellspacing="0" role="presentation">
                                <tbody>
                                    <tr>                                    
                                        <td class="paddingleft"><img id="FooterLogoImage" title="Microsoft" src="/images/footer_logo_grey_bg.png" alt="Microsoft" style="height:15px;" /></td>
                                        <td id="CopyrightNotice" class="paddingleft">Â©2021 Microsoft Corporation</td>

                                        <td class="paddingleft"><a href="https://www.microsoft.com/en-US/servicesagreement/" id="LegalLinkAnchor" target="_blank">Legal</a></td>
                                        <td class="paddingleft"><a href="https://privacy.microsoft.com/en-US/privacystatement" id="PrivacyLinkAnchor" target="_blank">Privacy</a></td>                                        
                                        <td class="paddingleft"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                        <td class="supportCodeCell" align="right">
                            <table cellpadding="0" cellspacing="0" role="presentation">
                                <tbody>
                                    <tr>
                                        <td class="alignright paddingright" id="SupportCodeContainer"><a href="javascript:ShowSupportCode()">Support code</a></td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <br/>

      
        
        <script type="text/javascript">
            var BANNER_LOGO_URL_KEY = "BannerLogoUrl";
            var TENANT_BRAND_NAME_KEY = "TenantBrandName";

            function SendCaptchaErrorToServer(result)
            {
                try
                {
                        $.ajax({
                            type: "POST",
                            url: "Default.aspx/ReportCaptchaResult",
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            data: JSON.stringify({
                                captchaResult: result
                            }),
                            success: function (response)
                            {
                            },
                            error: function (response)
                            {
                            }
                        });
                }
                catch (error)
                {
                   
                }
            }
            function UpdateTenantBrandingBannerLogo()
            {
                try
                {
                    var orgIdTenantDomain = jQuery.trim($('#OrgIdTenantDomain').val());
                    var orgIdUserName = jQuery.trim($('#OrgIdUserName').val());
                    var NameCoexistenceAccountValue = jQuery.trim($('#NameCoexistenceAccount').val());
                    var localAccountRequest = false;

                    if (NameCoexistenceAccountValue == "1")
                    {
                        localAccountRequest = true;
                    }

                    if (LogoHasBeenPreviouslyLoaded())
                    {
                        UpdateLogo(localAccountRequest);
                    }
                    else if (orgIdTenantDomain.length > 0 || orgIdUserName.length > 0)
                    {
                        $.ajax({
                            type: "POST",
                            url: "Default.aspx/GetBrandingInfo",
                            data: JSON.stringify({
                                tenantDomain: orgIdTenantDomain,
                                userName: orgIdUserName,
                                isLocalAccount: localAccountRequest
                            }),
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            success: function (response)
                            {
                                if (response.d && response.d.length > 0)
                                {
                                    var tenantInfo = JSON.parse(response.d);

                                    if (tenantInfo.BannerLogoUrl && tenantInfo.TenantBrandName)
                                    {
                                        SetBannerLogoUrl(tenantInfo.BannerLogoUrl);
                                        SetTenantBrandName(tenantInfo.TenantBrandName);
                                    } else {
                                        SetDefaultTenantBrandNameAndBannerLogoUrl();
                                    }

                                    UpdateLogo(localAccountRequest);

                                }
                                else
                                {
                                    SetOrHideDefaultLogo(localAccountRequest);
                                }
                            },
                            error: function (response)
                            {
                                SetOrHideDefaultLogo(localAccountRequest);
                            }
                        });
                    }
                    else
                    {
                        SetOrHideDefaultLogo(localAccountRequest);
                    }
                }
                catch(error) 
                {
                    SetOrHideDefaultLogo(localAccountRequest);
                }
            }

            function LogoHasBeenPreviouslyLoaded()
            {
                return GetBannerLogoUrl().length > 0;
            }

            function SetOrHideDefaultLogo(isLocalAccountRequest)
            {
                SetDefaultTenantBrandNameAndBannerLogoUrl();
                if (isLocalAccountRequest)
                {
                    $("#HeaderImage").hide();
                }
                else {
                    UpdateLogo(isLocalAccountRequest);
                } 
            }

            function UpdateLogo(isLocalAccountRequest)
            {
                if (isLocalAccountRequest) 
                {
                    $("#HeaderImage").attr("src", "images/wait_animation.gif");
                }
                UpdateLogoTitle();
                var logoUrl = GetBannerLogoUrl();
                $("#HeaderImage").attr("src", logoUrl).show();
            }

            function UpdateLogoTitle()
            {
                var tenantBrandName = GetTenantBrandName();
                $("#HeaderImage").attr("title", tenantBrandName);
                $("#HeaderImage").attr("alt", tenantBrandName);
            }

            function GetBannerLogoUrl()
            {
                return GetUserSessionData(BANNER_LOGO_URL_KEY);
            }

            function SetBannerLogoUrl(url)
            {
                SetUserSessionData(BANNER_LOGO_URL_KEY, url);
            }

            function SetDefaultBannerLogoUrl()
            {
                var DEFAULT_BANNER_LOGO_URL = "images/header_Microsoft.png";
                SetBannerLogoUrl(DEFAULT_BANNER_LOGO_URL);
            }

            function GetTenantBrandName()
            {
                var tenantBrandName = GetUserSessionData(TENANT_BRAND_NAME_KEY) || GetDefaultTenantBrandName();

                return String.format('{0} branding image', tenantBrandName);
            }

            function SetTenantBrandName(tenantBrandName)
            {
                SetUserSessionData(TENANT_BRAND_NAME_KEY, tenantBrandName);
            }

            function SetDefaultTenantBrandName()
            {
                SetTenantBrandName(GetDefaultTenantBrandName());
            }

            function GetDefaultTenantBrandName()
            {
                return 'Company';
            }

            function SetDefaultTenantBrandNameAndBannerLogoUrl() {
                SetDefaultTenantBrandName();
                SetDefaultBannerLogoUrl();
            }

            function ClearTenantBrandNameAndBannerLogoUrl() {
                DeleteUserSessionData(TENANT_BRAND_NAME_KEY);
                DeleteUserSessionData(BANNER_LOGO_URL_KEY);
            }

            function PrePopulateUserName()
            {
                try
                {
                    var userName = $('#OrgIdUserName').val();
                    if (userName.length > 0 )
                    {
                        var pattern = /&#39;/g;
                        $("#ContentPlaceholderMainContent_TextBoxUserIdentifier").attr("value", userName.trim().replace(pattern, "'"));
                    }
                }
                catch (err)
                { }
            }

            function PopulateUserNameHiddenFieldAndRefreshLogo()
            {
                try
                {
                    var userName = $('#ContentPlaceholderMainContent_TextBoxUserIdentifier').val();
                    if (userName.length > 0)
                    {
                        $("#OrgIdUserName").attr("value", userName.trim());
                        ClearTenantBrandNameAndBannerLogoUrl();
                        UpdateTenantBrandingBannerLogo();
                    }

                }
                catch (err)
                { }
            }

            function OnLoad()
            {
                var loaded = document.createElement('input');
                loaded.type = 'hidden';
                loaded.id = 'HiddenLoaded';
                document.body.appendChild(loaded);
                PrePopulateUserName();
                UpdateTenantBrandingBannerLogo();
                SuppressEnterKeySubmitEventPropogation();
            }

            function SuppressEnterKeySubmitEventPropogation() {
                $('.noEnterSubmit').bind('keypress', function (e) {
                    if (e && (e.keyCode== 13) || (e.charCode==13)) return false;
                    return true;
                });
            }

            function ShowSupportCode() {
                $get('SupportCodeContainer').innerHTML = $get('CorrelationID').value;
            }

            Sys.WebForms.PageRequestManager.getInstance().add_endRequest(
                function (sender, args) {
                    if (args.get_error() && args.get_error().name == 'Sys.WebForms.PageRequestManagerTimeoutException') {
                        args.set_errorHandled(true);
                        window.location.pathname = '/Timeout.aspx';
                    }
                }
            );
        </script>
    
<script type="text/javascript">
//<![CDATA[
var Page_Validators =  new Array(document.getElementById("ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier"), document.getElementById("ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier"), document.getElementById("ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains"));
//]]>
</script>

<script type="text/javascript">
//<![CDATA[
var ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier = document.all ? document.all["ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier"] : document.getElementById("ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier");
ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier.controltovalidate = "ContentPlaceholderMainContent_TextBoxUserIdentifier";
ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier.focusOnError = "t";
ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier.errormessage = "Please type your email address in the format user@contoso.onmicrosoft.com or user@contoso.com";
ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier.display = "Dynamic";
ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier.initialvalue = "";
var ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier = document.all ? document.all["ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier"] : document.getElementById("ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier");
ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier.controltovalidate = "ContentPlaceholderMainContent_TextBoxUserIdentifier";
ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier.focusOnError = "t";
ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier.errormessage = "Please type your email address in the format user@contoso.onmicrosoft.com or user@contoso.com";
ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier.display = "Dynamic";
ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier.evaluationfunction = "RegularExpressionValidatorEvaluateIsValid";
ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier.validationexpression = "^\\s*[a-zA-Z0-9~;&#^\\\\!.\'_%-]+@[a-zA-Z0-9](?!.*\\.\\..*)[a-zA-Z0-9.-]*\\.[a-zA-Z]{2,25}\\s*$";
var ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains = document.all ? document.all["ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains"] : document.getElementById("ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains");
ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains.controltovalidate = "ContentPlaceholderMainContent_TextBoxUserIdentifier";
ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains.focusOnError = "t";
ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains.errormessage = "Microsoft Accounts or personal email addresses donâ€™t work here.  Make sure you enter your work or school account (e.g. user@contoso.com).  If you want to reset a Microsoft Account password, <a href=\"https://account.live.com/resetpassword.aspx\" >click here</a>.";
ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains.display = "Dynamic";
ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains.evaluationfunction = "RegularExpressionValidatorEvaluateIsValid";
ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains.validationexpression = "^(?:(?!@gmail.com|@hotmail.com|@yahoo.com|@aol.com|@icloud.com|@comcast.net|@contoso.com|@outlook.com|@office.com|@office365.com|@microsoftonline.com|@sharepoint.com|@windows.com).)*$\\r?\\n?";
//]]>
</script>


<script type="text/javascript">
//<![CDATA[
$addHandler(window.document.documentElement, 'mouseup', Button.MouseUp); Sys.Application.add_init(Button.ResizeButtons);
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
        WebForm_AutoFocus('ContentPlaceholderMainContent_TextBoxUserIdentifier');
document.getElementById('ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('ContentPlaceholderMainContent_RequiredFieldValidatorUserIdentifier'));
}

document.getElementById('ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('ContentPlaceholderMainContent_RegularExpressionValidatorUserIdentifier'));
}

document.getElementById('ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('ContentPlaceholderMainContent_RegularExpressionNonOrgIDDomains'));
}
Button.DefaultButton='ContentPlaceholderMainContent_ButtonNext';$addHandler(window.document.documentElement, 'keyup', Button.DefaultButtonKeyUpHandler);$addHandler(window.document.documentElement, 'keydown', Button.DefaultButtonKeyDownHandler);Button.AttachDefaultButtonHandlers();Sys.Application.add_init(function() {
    $create(Sys.UI._UpdateProgress, {"associatedUpdatePanelId":"ContentPlaceholderMainContent_UpdatePanelMain","displayAfter":0,"dynamicLayout":false}, null, null, $get("ContentPlaceholderMainContent_UpdateProgress1"));
});
//]]>
</script>
</form>
</body>
</html>

